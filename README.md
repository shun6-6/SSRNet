如图展示了SRRToR交换机的整体架构以及数据流示意图。从功能模块划分的角度来看，SRRToR交换机主要由以下结构单元组成：以太网连接子系统、以太网数据交换单元、以太网数据传输引擎、带内控制协议处理引擎以及DDR4存储子系统。其中以太网数据传输引擎、带内控制协议处理单元以及以太网数据交换单元作为SRRToR交换机的核心功能模块，采用完全自主研发的寄存器传输级（Register Transfer Level，RTL）设计实现，以确保对关键功能的精确控制和性能优化；其余面向连接和数据处理的基础子系统，则选用经过硅后验证的成熟商用IP Core进行开发，从而提高开发效率并确保系统的可靠性和可移植性。
从数据流的角度分析，SRRToR交换机的下行链路通过10G以太网光模块与服务器（Server）进行连接，对于本地机架内的数据交换，系统通过SRRToR内部实现的以太网交换机直接完成转发；而对于跨机架的数据传输，则通过以太网数据传输引擎将数据写入DDR4存储子系统中进行缓存，等待对应时隙完成转发。以太网数据传输引擎作为关键的数据通路模块，位于以太网接口与DDR4存储子系统之间，负责实现以太网接口与存储系统之间的高效并行数据传输，确保数据处理的低延迟与高吞吐量。在SRRToR交换机的上行链路设计中，系统通过10G以太网光模块和光纤与快速OCSes连接，利用OCSes完成SRRToR之间的数据传输。在跨机架数据传输过程中，除了以太网数据传输引擎和以太网交换机的参与外，还通过带内控制协议处理引擎实现所有SRRToR之间的时间同步以及DFOCS-TU算法的运行过程，这一设计确保了跨机架数据传输的高效性与可靠性。

![设计框图](\picture\pic1.png "Shiprock")

顶层例化模块如下：
 + VCU128_10G_eth_top：10G以太网连接子系统，支持1-4路10G光纤连接。其子模块如下：两个上行10G链路，两个下行10G链路，以及用于测试的内置服务器模块。
 + Time_syn_module：时间同步模块，支持纳秒级时间同步，可在顶层设置Master和Slave。
 + VLB_module：DFOCS_TU算法计算模块，可灵活替换自主设计的新算法
 + DDR_rd_ctrl：DDR读写控制状态机，与VLB_module和block_design配合使用
 + Forward_pkt_buffer：时隙内调度时用于两跳数据缓存的队列模块，受VLB_module和DDR_rd_ctrl模块控制，替换新算法时直接注释掉即可
 + Eth_up_link：以太网上行链路端口，与VCU128_10G_eth_top连接，为上行链路进行一些预处理操作，如数据包过滤，数据流仲裁等
 + Crossbar：以太网电交换机模块
 + Design：block design 设计，内部集成了4组以太网数据传输引擎，支持1-4路10G以太网数据的双向搬移（DDR4→以太网子系统，DDR4←以太网子系统）
 + Mem_manager：内存管理模块，对DDR缓存空间中所有队列进行控制，处理读写控制描述符，队列查询指令等。
